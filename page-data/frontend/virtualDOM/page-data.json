{"componentChunkName":"component---src-templates-blog-post-js","path":"/frontend/virtualDOM/","result":{"data":{"site":{"siteMetadata":{"title":"Avocode","author":"[eatnug]","siteUrl":"https://eatnug.github.io","comment":{"disqusShortName":"","utterances":"eatnug/inbox"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"8b95b93d-3eb6-5cb8-aa76-b86794aa4c12","excerpt":"본 글은 virtual DOM에 관한 Ire Aderinokun 글을 번역한 것 입니다. 이해를 돕기위한 의역이 존재합니다. 나는 최근 DOM 과 shadow DOM 이 정확이 무엇이고 그들이 어떻게 다른지에 대한 글을 썼다. 요약하자면 Document Object Model은 HTML 문서에 대한 객체 기반 표현 그리고 그 객체를 조작하기 위한 인터페이스를 의미한다. Shadow DOM은 DOM의 ‘가벼운’ 버젼이라고 생각할 수 있다. 이 또한 HTML…","html":"<blockquote>\n<p>본 글은 virtual DOM에 관한 <a href=\"https://ireaderinokun.com/\">Ire Aderinokun</a> 글을 번역한 것 입니다. 이해를 돕기위한 의역이 존재합니다.</p>\n</blockquote>\n<p>나는 최근 <a href=\"https://bitsofco.de/what-exactly-is-the-dom/\">DOM</a> 과 <a href=\"https://bitsofco.de/what-is-the-shadow-dom/\">shadow DOM</a> 이 정확이 무엇이고 그들이 어떻게 다른지에 대한 글을 썼다. 요약하자면 Document Object Model은 HTML 문서에 대한 객체 기반 표현 그리고 그 객체를 조작하기 위한 인터페이스를 의미한다. Shadow DOM은 DOM의 ‘가벼운’ 버젼이라고 생각할 수 있다. 이 또한 HTML 엘리먼트에 대한 객체 기반 표현이지만 완전히 독립적인 문서는 아니다. 대신에 shadow DOM은 DOM을 더 작고 캡슐화 된 부분들로 나누어 여러 HTML 문서에 걸쳐 사용할 수 있게 해준다.</p>\n<p>아마 ‘virtual DOM’ 이라는 이와 유사한 용어를 본 적이 있을 것이다. 사실 그 개념은 수 년간 존재해왔지만 React 프레임워크(역자 주: 리액트는 프레임워크라기 보다는 라이브러리에 가깝지만 원작자의 표현을 존중한다. 후술할 프레임워크도 같은 맥락에서 살려둔다.)에서 사용되었다는 점 때문에 유명해졌다. 이 글에서는 virtual DOM이 정확히 무엇이고, 이것이 기존의 DOM과 어떻게 다르며, 어떻게 사용되는지에 대해 알아\n볼 것이다.</p>\n<h2 id=\"왜-virtual-dom이-필요한가\" style=\"position:relative;\"><a href=\"#%EC%99%9C-virtual-dom%EC%9D%B4-%ED%95%84%EC%9A%94%ED%95%9C%EA%B0%80\" aria-label=\"왜 virtual dom이 필요한가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>왜 virtual DOM이 필요한가?</h2>\n<p>virtual DOM이라는 개념이 왜 떠오르고 있는지 이해하기 위해서 먼저 기존의 DOM을 다시 살펴보자. 앞서 언급한대로, DOM은 두 부분으로 구성된다 - HTML 문서에 대한 객체 기반 표현 그리고 이 객체를 조작하기 위한 API.</p>\n<p>예를 들어 <code class=\"language-text\">&lt;ul&gt;</code>과 <code class=\"language-text\">&lt;li&gt;</code>로 이루어진 간단한 HTML 문서를 살펴보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\">&lt;!DOCTYPE html></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>list<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>list__item<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>List item<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>이 문서는 다음의 DOM tree로 표현될 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 621px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACgUlEQVQ4y5VU30uaURj+/pqxu7W2tbkmLCLHoGkjxZJ20/Im7+xmY6KBa7k0xRA02UVsY2k0u1vQZaSVs7oJvNAI8jdWlL9Ks56d98AXBpbswPNxeL/zPe/zvs97PqFQKCCTySCZTCKfz6NcLqNUKnHQ/n8hhMNhKJVKqNVq6HQ6FItFUJLT09MboJiY5K5kwu7uLvR6PcbGxjA7O4u7VqVSaalcODs7w8nJCYjY7XbD4XDA6XTCbpuGY9oOh90Ou9WGb14vjo6OWpIK9KAyV1ZWoFAo8H54GEqVCp0P29EnkaLrcQe62h6ht0eGZCqF8/Nzfv5WQspImaPRKAKBAObn5+H3+7G6uoq/m2FsbmwgFAohsrXF+9jKNIFeEGkwGMTg4CBGRka4STs7O7xvtVoNl5eXqF9ccGWtjOGE1WoV6XQaJpMJZrMZNpsN+/v714QX9TpqDHVGXGnlspiNzCHEYjF4PB4YDAYYPnzk+MRgZPjCkmVzOf4hld9slASxH2Jge3sbGo0G0hdSvO3qxrvXvVB090DdLYNK0Yfj42Ou/IqppUUmNSoWxE1jMB6P857+WV6Gb8EP/+Iifi0s4PfSEtZYfJ0ZtbYeQjAURIo5T5VdK2wkE5WSCXt7e9Bqteh8+gx90pd4wyCTdOJVhwRPHrRB/lyK9nv34fP5uFK6TU0ViqRU2tzcHMaNRnicM3BN04Bb4bI7OLwzLlgnLYhEIqgzw8TZFJo5JY4SrfzhIb7//AHjuAmTFgssU1/xeWICU2wSyPVGsqaEjUrJxRxzVTc6CrlcjoGBAQwNDfEfSX9/P7LZ7PVVvNHD20CHyEW6SQcHB0gkEhy0J7JmQ/4PfPxNhdvdVLoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"domTree\"\n        title=\"domTree\"\n        src=\"/static/60f254686d67b095c61e20e0529e5ba5/3075e/domTree.png\"\n        srcset=\"/static/60f254686d67b095c61e20e0529e5ba5/5a46d/domTree.png 300w,\n/static/60f254686d67b095c61e20e0529e5ba5/0a47e/domTree.png 600w,\n/static/60f254686d67b095c61e20e0529e5ba5/3075e/domTree.png 621w\"\n        sizes=\"(max-width: 621px) 100vw, 621px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>첫번째 <code class=\"language-text\">&lt;li&gt;</code>의 내용을 <code class=\"language-text\">&quot;List item one&quot;</code>으로 수정하고 <code class=\"language-text\">&lt;li&gt;</code>를 하나 더 추가하고 싶다고 생각해보자. 우선 DOM API를 이용해 우리가 업데이트 하고 싶은 엘리먼트를 찾는다. 그리고 추가 할 새로운 엘리먼트를 만들고, 여기에 속성과 내용을 부여한다. 이 모든 작업이 끝나고서야 마침내 우리는 DOM 엘리먼트들을 업데이트 할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> listItemOne <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByClassName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'list__item'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\nlistItemOne<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> <span class=\"token string\">'List item one'</span>\n\n<span class=\"token keyword\">const</span> list <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByClassName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'list'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">const</span> listItemTwo <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'li'</span><span class=\"token punctuation\">)</span>\nlistItemTwo<span class=\"token punctuation\">.</span>classList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'list__item'</span><span class=\"token punctuation\">)</span>\nlistItemTwo<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> <span class=\"token string\">'List item two'</span>\nlist<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>listItemTwo<span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"dom은-그러라고-만든게-아닌데\" style=\"position:relative;\"><a href=\"#dom%EC%9D%80-%EA%B7%B8%EB%9F%AC%EB%9D%BC%EA%B3%A0-%EB%A7%8C%EB%93%A0%EA%B2%8C-%EC%95%84%EB%8B%8C%EB%8D%B0\" aria-label=\"dom은 그러라고 만든게 아닌데 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DOM은 그러라고 만든게 아닌데…</h3>\n<p>1998년, (DOM 에 대한 첫 번째 명세)[https://www.w3.org/TR/REC-DOM-Level-1/]가 처음 배포되었을 때 까지만 하더라도, 우리는 웹 페이지들을 굉장히 다르게 제작하고 운영했다. 오늘날에 비해 DOM API를 사용해 페이지의\n내용을 수정해야하는 경우가 훨씬 적었다.</p>\n<p><code class=\"language-text\">document.getElementByClassName()</code> 같은 간단한 메소드들은 작은 스케일에서 사용해도 괜찮다. 하지만 만약 우리가 매 초마다 여러 엘리먼트를 업데이트 해야한다면, 지속적으로 DOM에 요청을 보내고 업데이트 하는 비용은 점점 비싸지기 시작한다.</p>\n<p>심지어 DOM API의 특성 상, 특정 요소 하나만 찾아내서 업데이트 하는 작업 보다, 많은 부분을 업데이트하는 비싼 작업이 더 간단하다. 우리의 리스트 예제를 다시 보면, 리스트 전체를 새 것으로 바꿔치기 하는게, 특정 엘리먼트 하나만 업데이트 하는 것보다 쉽다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> list <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByClassName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'list'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\nlist<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n&lt;li class=\"list__item\">List item one&lt;/li>\n&lt;li class=\"list__item\">List item two&lt;/li>\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre></div>\n<p>이 예제에서만 보면, 두 메소드의 성능 차이는 아마도 크지 않을 것이다. 하지만 웹페이지의 크기가 커짐에 따라, 필요한 엘리먼트만 선택하고 업데이트 하는 것이 더 중요해질 것이다.</p>\n<h3 id=\"virtual-dom은-그러라고-만든게-맞다\" style=\"position:relative;\"><a href=\"#virtual-dom%EC%9D%80-%EA%B7%B8%EB%9F%AC%EB%9D%BC%EA%B3%A0-%EB%A7%8C%EB%93%A0%EA%B2%8C-%EB%A7%9E%EB%8B%A4\" aria-label=\"virtual dom은 그러라고 만든게 맞다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>virtual DOM은 그러라고 만든게 맞다!</h3>\n<p>virtual DOM은 이렇게 DOM을 빈번하게 업데이트 해야하는 문제를 해결하기 위해 만들어졌다. DOM이나 shadow DOM과 달리 virtual DOM은 공식적인 스펙은 아니고, DOM과 인터페이스 하기 위한 새로운 메소드 정도로 볼 수 있다.</p>\n<p>virtual DOM은 기존 DOM의 복사본이라고 볼 수 있는데, 이 복사본은 DOM API들을 사용하지 않고도 주기적으로 조작되고 업데이트 될 수 있다. virtual DOM에 모든 변경사항이 반영되면 우리는 원본 DOM에 정확히 어떤 변화가 필요한 지 알 수 있고 필요한 변화만 최적화 해서 반영할 수 있다.</p>\n<h2 id=\"virtual-dom은-어떻게-생겼을까\" style=\"position:relative;\"><a href=\"#virtual-dom%EC%9D%80-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%83%9D%EA%B2%BC%EC%9D%84%EA%B9%8C\" aria-label=\"virtual dom은 어떻게 생겼을까 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>virtual DOM은 어떻게 생겼을까?</h2>\n<p>사실 virtual DOM이라는 이름 때문에 그 개념이 더 어렵게 느껴지곤 한다. 사실 virtual DOM은 평범한 자바스크립트 객체이다.</p>\n<p>우리가 만든 DOM tree를 다시 한번 보자.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 621px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACgUlEQVQ4y5VU30uaURj+/pqxu7W2tbkmLCLHoGkjxZJ20/Im7+xmY6KBa7k0xRA02UVsY2k0u1vQZaSVs7oJvNAI8jdWlL9Ks56d98AXBpbswPNxeL/zPe/zvs97PqFQKCCTySCZTCKfz6NcLqNUKnHQ/n8hhMNhKJVKqNVq6HQ6FItFUJLT09MboJiY5K5kwu7uLvR6PcbGxjA7O4u7VqVSaalcODs7w8nJCYjY7XbD4XDA6XTCbpuGY9oOh90Ou9WGb14vjo6OWpIK9KAyV1ZWoFAo8H54GEqVCp0P29EnkaLrcQe62h6ht0eGZCqF8/Nzfv5WQspImaPRKAKBAObn5+H3+7G6uoq/m2FsbmwgFAohsrXF+9jKNIFeEGkwGMTg4CBGRka4STs7O7xvtVoNl5eXqF9ccGWtjOGE1WoV6XQaJpMJZrMZNpsN+/v714QX9TpqDHVGXGnlspiNzCHEYjF4PB4YDAYYPnzk+MRgZPjCkmVzOf4hld9slASxH2Jge3sbGo0G0hdSvO3qxrvXvVB090DdLYNK0Yfj42Ou/IqppUUmNSoWxE1jMB6P857+WV6Gb8EP/+Iifi0s4PfSEtZYfJ0ZtbYeQjAURIo5T5VdK2wkE5WSCXt7e9Bqteh8+gx90pd4wyCTdOJVhwRPHrRB/lyK9nv34fP5uFK6TU0ViqRU2tzcHMaNRnicM3BN04Bb4bI7OLwzLlgnLYhEIqgzw8TZFJo5JY4SrfzhIb7//AHjuAmTFgssU1/xeWICU2wSyPVGsqaEjUrJxRxzVTc6CrlcjoGBAQwNDfEfSX9/P7LZ7PVVvNHD20CHyEW6SQcHB0gkEhy0J7JmQ/4PfPxNhdvdVLoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"domTree\"\n        title=\"domTree\"\n        src=\"/static/60f254686d67b095c61e20e0529e5ba5/3075e/domTree.png\"\n        srcset=\"/static/60f254686d67b095c61e20e0529e5ba5/5a46d/domTree.png 300w,\n/static/60f254686d67b095c61e20e0529e5ba5/0a47e/domTree.png 600w,\n/static/60f254686d67b095c61e20e0529e5ba5/3075e/domTree.png 621w\"\n        sizes=\"(max-width: 621px) 100vw, 621px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>이 트리는 다음과 같은 자바스크립트 객체로 표현될 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> vdom <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  tagName<span class=\"token operator\">:</span> <span class=\"token string\">'html'</span><span class=\"token punctuation\">,</span>\n  children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span> tagName<span class=\"token operator\">:</span> <span class=\"token string\">'head'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      tagName<span class=\"token operator\">:</span> <span class=\"token string\">'body'</span><span class=\"token punctuation\">,</span>\n      children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n          tagName<span class=\"token operator\">:</span> <span class=\"token string\">'ul'</span><span class=\"token punctuation\">,</span>\n          attributes<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">class</span><span class=\"token operator\">:</span> <span class=\"token string\">'list'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n              tagName<span class=\"token operator\">:</span> <span class=\"token string\">'li'</span><span class=\"token punctuation\">,</span>\n              attributes<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">class</span><span class=\"token operator\">:</span> <span class=\"token string\">'list__item'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n              textContent<span class=\"token operator\">:</span> <span class=\"token string\">'List item'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// end li</span>\n          <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// end ul</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// end body</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token comment\">// end html</span></code></pre></div>\n<p>이 객체를 virtual DOM이라고 생각하면 된다. 원본 DOM과 마찬가지로, 이는 HTML 문서에 대한 객체기반 표현이다. 하지만 동시에 자바스크립트 객체이므로 언제나 자유롭게 이를 수정할 수 있고, 꼭 필요한 경우가 아니라면 실제 DOM은 전혀 건드릴 필요가 없다.</p>\n<p>매번 전체 객체를 다 사용하기 보다는, 보통은 virtual DOM의 작은 섹션을 따로 나누어서 사용한다. 예를 들어 우리는 아까 만든 <code class=\"language-text\">&lt;ul&gt;</code> 엘리먼트와 대응되는 list 컴포넌트에서 작업을 수행할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> list <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  tagName<span class=\"token operator\">:</span> <span class=\"token string\">'ul'</span><span class=\"token punctuation\">,</span>\n  attributes<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">class</span><span class=\"token operator\">:</span> <span class=\"token string\">'list'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      tagName<span class=\"token operator\">:</span> <span class=\"token string\">'li'</span><span class=\"token punctuation\">,</span>\n      attributes<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">class</span><span class=\"token operator\">:</span> <span class=\"token string\">'list__item'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      textContent<span class=\"token operator\">:</span> <span class=\"token string\">'List item'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"virtual-dom의-내부를-살펴보자\" style=\"position:relative;\"><a href=\"#virtual-dom%EC%9D%98-%EB%82%B4%EB%B6%80%EB%A5%BC-%EC%82%B4%ED%8E%B4%EB%B3%B4%EC%9E%90\" aria-label=\"virtual dom의 내부를 살펴보자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>virtual DOM의 내부를 살펴보자</h2>\n<p>우린 virtual DOM이 어디에 사용되는지 살펴보았는데, virtual DOM은 어떻게 이런 문제를 해결하는 것일까?</p>\n<p>앞서 언급한 대로, virtual DOM을 사용하면 우리는 DOM에서 변화가 생긴 부분만 콕 집어서 업데이트 할 수 있다. 다시 우리의 예제로 돌아가서 DOM API로 했던 것과 같은 변화를 만들어 보자.</p>\n<p>가장 먼저 할 일은 우리의 변경사항이 반영된 virtual DOM의 복사본을 만드는 것이다. 우리는 DOM API를 쓸 필요가 없다. 그냥 객체만 만들면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> copy <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  tagName<span class=\"token operator\">:</span> <span class=\"token string\">'ul'</span><span class=\"token punctuation\">,</span>\n  attributes<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">class</span><span class=\"token operator\">:</span> <span class=\"token string\">'list'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      tagName<span class=\"token operator\">:</span> <span class=\"token string\">'li'</span><span class=\"token punctuation\">,</span>\n      attributes<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">class</span><span class=\"token operator\">:</span> <span class=\"token string\">'list__item'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      textContent<span class=\"token operator\">:</span> <span class=\"token string\">'List item one'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      tagName<span class=\"token operator\">:</span> <span class=\"token string\">'li'</span><span class=\"token punctuation\">,</span>\n      attributes<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">class</span><span class=\"token operator\">:</span> <span class=\"token string\">'list__item'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      textContent<span class=\"token operator\">:</span> <span class=\"token string\">'List item two'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 <code class=\"language-text\">copy</code>는 <code class=\"language-text\">diff</code>라는 것을 만드는것에 사용되는데 이 경우에는 <code class=\"language-text\">list</code> 그리고 업데이트 된 항목을 나타낸다. <code class=\"language-text\">diff</code>는 다음과 같이 생겼다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> diffs <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n        newNode<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* new version of list item one */</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        oldNode<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* original version of list item one */</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        index<span class=\"token operator\">:</span> <span class=\"token comment\">/* index of element in parent's list of child nodes */</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n        newNode<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* list item two */</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        index<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* */</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>이 <code class=\"language-text\">diff</code>는 실제 DOM 을 어떻게 업데이트 할 것인지 알려준다. 모든 <code class=\"language-text\">diff</code>들이 다 수집되고 나면, 그때 실제 DOM에게 변화를 발생시긴다. 이때 오직 변화가 필요한 부분만 업데이트된다.</p>\n<p>예를 들어 우리는 각각의 <code class=\"language-text\">diff</code>를 순회하면서 새로운 자식 노드를 추가하거나, 기존의 노드를 업데이트 할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> domElement <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByClassName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'list'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\ndiffs<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">diff</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> newElement <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span>diff<span class=\"token punctuation\">.</span>newNode<span class=\"token punctuation\">.</span>tagName<span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">/* Add attributes ... */</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>diff<span class=\"token punctuation\">.</span>oldNode<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// If there is an old version, replace it with the new version</span>\n    domElement<span class=\"token punctuation\">.</span><span class=\"token function\">replaceChild</span><span class=\"token punctuation\">(</span>diff<span class=\"token punctuation\">.</span>newNode<span class=\"token punctuation\">,</span> diff<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// If no old version exists, create a new node</span>\n    domElement<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>diff<span class=\"token punctuation\">.</span>newNode<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>이건 실제 virtual DOM의 동작을 아주 간단히 설명한 것이라는 것을 명심하길 바란다. 여기서 다루지 않은 경우의 수도 많이 존재한다.</p>\n<h2 id=\"virtul-dom-과-프레임워크\" style=\"position:relative;\"><a href=\"#virtul-dom-%EA%B3%BC-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC\" aria-label=\"virtul dom 과 프레임워크 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>virtul DOM 과 프레임워크</h2>\n<p>우리의 예시처럼 직접 virtual DOM을 다루는 것 보다는, 프레임워크를 통해 다루는 것이 훨씬 보편적이다.</p>\n<p>React나 Vue같은 프레임워크들은 DOM업데이트를 더 효율적으로 수행하기 위해 virtual DOM 개념을 사용한다. 예를 들어 우리의 <code class=\"language-text\">list</code> 컴포넌트를 React로 작성하면 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> ReactDOM <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom'</span>\n\n<span class=\"token keyword\">const</span> list <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span>\n  <span class=\"token string\">'ul'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> className<span class=\"token operator\">:</span> <span class=\"token string\">'list'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'li'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> className<span class=\"token operator\">:</span> <span class=\"token string\">'list__item'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'List item'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\n\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-text\">list</code>를 업데이트 하고싶다면, 그냥 템플릿 전체를 다시 써버리고 다시 한번 <code class=\"language-text\">ReactDOM.render()</code>를 호출하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> newList <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ul\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> className<span class=\"token operator\">:</span> <span class=\"token string\">\"list\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"li\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> className<span class=\"token operator\">:</span> <span class=\"token string\">\"list__item\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"List item one\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"li\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> className<span class=\"token operator\">:</span> <span class=\"token string\">\"list__item\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"List item two\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>newList<span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>React는 virtual DOM을 사용하기 때문에, 전체 템플릿을 렌더링해도, 실제로는 변경된 부분만 업데이트 한다.개발자 도구를 연 채로 변화를 확인하면 특정 엘리먼트만 변화한다는 것을 확인할 수 있다.</p>\n<h2 id=\"dom-vs-virtual-dom\" style=\"position:relative;\"><a href=\"#dom-vs-virtual-dom\" aria-label=\"dom vs virtual dom permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DOM vs virtual DOM</h2>\n<p>요약하자면, virtual DOM은 DOM엘리먼트를 좀 더 쉽고 효율적인 방식으로 다룰 수 있게 해주는 도구이다. 자바스크립트 객체로 표현된 DOM이고, 우리가 언제든지 필요하다면 수정할 수 있다. virtual DOM에 만들어진 변화들은 실제 DOM과 대조되고, 실제 DOM에 덜 빈번하게 반영된다.</p>\n<h2 id=\"원문\" style=\"position:relative;\"><a href=\"#%EC%9B%90%EB%AC%B8\" aria-label=\"원문 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>원문</h2>\n<ul>\n<li><a href=\"https://bitsofco.de/understanding-the-virtual-dom/\">Understanding the Virtual DOM</a> - by <a href=\"https://ireaderinokun.com/\">Ire Aderinokun</a></li>\n</ul>","frontmatter":{"title":"번역] Virtual DOM 이해하기","date":"November 19, 2019","tags":["dom","tranlated"],"category":"Frontend"}}},"pageContext":{"slug":"/frontend/virtualDOM/","previous":{"fields":{"slug":"/log/gatsby&github pages/"},"frontmatter":{"title":"GatsbyJS와 Github Pages로 블로그 만들기","category":"Logs"}},"next":{"fields":{"slug":"/frontend/react-redux/"},"frontmatter":{"title":"Redux로 React 앱 상태관리 하기","category":"Frontend"}}}}}